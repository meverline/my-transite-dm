<project xmlns:ivy="antlib:org.apache.ivy.ant" name="scala" default="dist" basedir=".">
	
    <!-- set global properties for this build -->
    <loadproperties srcFile="${basedir}/../config/properties/build.all.properties"/>
    <loadproperties srcFile="${basedir}/../config/properties/build.${os.name}.properties"/>
	
    <!-- targets for building the ecllipse project need to handle both windows and others -->
	
  	<include file="${ant.utilities.xml.file}" />
  	<include file="${ant.ecllipse.xml.file}" />
	
	<target name="libs" description="--> resolve external libs and fix class path">
		<antcall target="utilities.resolve"/>
	  	<copy file="../jar-repository/shapefilereader-1.0.jar" todir="${lib}" />
		<antcall target="ecllipse.classPath">
			<param name="${classpath.projectDepends.parm}" value="/config"/>
			<param name="${classpath.includeSource.parm}" value="false"/>
			<param name="${classpath.exclude.parm}" value="swingx%transite-common"/>
		</antcall>
	</target>

  	<target name="init">
	    <!-- Create the time stamp -->
	    <tstamp/>
	    <!-- Create the build directory structure used by compile -->
	    <mkdir dir="${build}"/>
	  	<mkdir dir="${dist}"/>
	  	<mkdir dir="${lib.dir}"/>
  		
  		<property name="scala.dir" location="${env.SCALA_HOME}"/>
  		<property name="scala-library.jar" location="${scala.dir}/lib/scala-library.jar"/>
  		<property name="scala-compiler.jar" location="${scala.dir}/lib/scala-compiler.jar"/>
	  	
	    <path id="project.classpath">
	      <pathelement location="${scala-library.jar}"/>
	      <pathelement location="${build-classes.dir}"/> <!-- used during recompilation -->
	    </path>
	 
	    <path id="scala.classpath">
	      <pathelement location="${scala-compiler.jar}"/>
	      <pathelement location="${scala-library.jar}"/>
	    </path>	
	 
	    <!-- load scala's ant tasks -->
	    <taskdef resource="scala/tools/ant/antlib.xml" classpathref="scala.classpath"/>

  	 </target>
	
	 <target name="compile" depends="init" unless="build.uptodate">
	    <mkdir dir="${build}"/>
	    <scalac
	      destdir="${build}"
	      classpathref="project.classpath">
	      <include name="**/*.scala"/>
	      <src><pathelement location="${src}"/></src>
	    </scalac>
	  </target>
	
	  <target name="dist" depends="compile"
	        description="generate the distribution" >
	    <!-- Create the distribution directory -->
	    <mkdir dir="${dist}/lib"/>

	    <!-- Put everything in ${build} into the MyProject-${DSTAMP}.jar file -->
	    <jar jarfile="${dist}/lib/transite-common-${transite-scala.ver}.jar" basedir="${build}" />
	  	<copy file="${dist}/lib/transite-common-${transite-scala.ver}.jar" todir="${lib}" />
	  </target>

</project>